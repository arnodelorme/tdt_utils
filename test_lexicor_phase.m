clear
srate = 250;
filein = 'data.asc';
[chans headerlines nc, res] = asc_readheader(filein);
[tmpdata res] = asc_readdata(filein,headerlines,nc);


chans([1 2 11 12 3 4 13 14 5 6 15 16 7 8 9 10 17 18 19 ]);
tmpdata = tmpdata([1 2 11 12 3 4 13 14 5 6 15 16 7 8 9 10 17 18 19 ],:);
maxpnts = floor(size(tmpdata,2)/srate)*srate;
tmpdata(:,maxpnts+1:end) = [];
tmpdata = reshape(tmpdata,size(tmpdata,1), srate, size(tmpdata,2)/srate);

phasevalstheta = [ ...
95.21	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
84.51	78.64	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
87.18	91.79	73.96	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
89.12	86.35	90.69	83.13	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
88.53	90.12	82.23	90.78	92.50	0	0	0	0	0	0	0	0	0	0	0	0	0;
76.34	71.94	86.43	69.32	85.65	78.57	0	0	0	0	0	0	0	0	0	0	0	0;
76.78	80.86	70.63	88.69	82.55	88.39	75.33	0	0	0	0	0	0	0	0	0	0	0;
79.96	77.80	84.10	77.73	91.03	87.01	92.10	84.18	0	0	0	0	0	0	0	0	0	0;
80.00	81.40	78.44	84.49	89.71	92.33	83.20	91.31	91.79	0	0	0	0	0	0	0	0	0;
72.10	69.24	74.65	68.58	79.44	76.02	89.39	77.84	89.07	83.38	0	0	0	0	0	0	0	0;
71.18	72.67	66.70	77.58	78.72	80.94	79.15	90.21	84.98	89.44	85.64	0	0	0	0	0	0	0;
74.52	72.50	77.35	73.28	84.19	81.51	89.91	83.00	94.15	89.12	94.41	87.79	0	0	0	0	0	0;
73.86	74.29	72.77	77.55	83.41	84.87	83.83	88.79	90.82	93.49	88.56	93.49	93.35	0	0	0	0	0;
69.34	68.41	68.56	68.83	77.30	76.02	84.33	78.72	86.89	83.47	93.49	88.50	93.71	90.46	0	0	0	0;
69.33	68.92	66.40	71.06	76.47	76.71	80.69	82.53	84.88	85.08	89.31	92.33	91.29	92.32	94.23	0	0	0;
89.84	88.93	86.48	86.84	95.83	96.21	82.96	84.54	89.84	91.91	78.12	80.13	83.29	84.08	76.65	76.42	0	0;
79.60	79.02	81.20	80.74	91.37	90.57	86.73	86.63	94.64	95.82	83.77	85.24	90.35	91.37	83.90	83.54	92.11	0;
74.41	73.61	75.93	75.40	84.99	84.33	86.97	85.91	93.76	92.16	89.49	89.00	95.36	95.37	91.04	90.41	85.13	93.66 ];

phasevalsalpha = [ ...
95.47	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
89.09	82.33	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
87.01	92.11	77.84	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
91.48	87.91	92.02	84.74	0	0	0	0	0	0	0	0	0	0	0	0	0	0;
90.77	91.87	85.24	92.37	92.72	0	0	0	0	0	0	0	0	0	0	0	0	0;
72.81	65.33	85.21	63.20	80.84	70.61	0	0	0	0	0	0	0	0	0	0	0	0;
72.14	75.68	67.59	85.78	76.19	84.46	66.09	0	0	0	0	0	0	0	0	0	0	0;
79.03	74.28	85.22	73.52	87.73	81.98	91.66	76.94	0	0	0	0	0	0	0	0	0	0;
80.40	80.47	77.86	85.27	86.46	90.61	75.12	91.57	85.77	0	0	0	0	0	0	0	0	0;
60.91	55.07	69.29	56.18	69.45	63.25	88.34	67.00	86.62	74.21	0	0	0	0	0	0	0	0;
61.45	61.16	62.03	71.09	68.54	72.71	69.65	89.24	76.82	87.18	77.95	0	0	0	0	0	0	0;
68.82	64.01	75.20	65.68	77.55	73.54	87.66	76.03	92.76	84.00	91.36	83.72	0	0	0	0	0	0;
69.20	67.49	70.90	74.15	76.96	78.76	76.01	87.51	85.96	91.90	80.71	92.94	90.30	0	0	0	0	0;
62.03	58.37	65.78	62.37	69.69	68.62	77.63	74.24	83.87	81.11	87.45	84.64	92.04	89.21	0	0	0	0;
60.06	58.02	62.33	64.86	67.69	68.46	72.27	79.99	79.58	83.45	81.87	90.78	87.73	92.33	93.77	0	0	0;
92.65	91.31	88.35	89.11	96.05	96.26	76.37	80.52	85.41	87.43	66.44	70.99	76.24	77.46	68.13	68.62	0	0;
83.22	81.18	83.26	81.79	91.07	90.67	81.72	84.89	92.52	94.35	77.28	82.49	88.72	89.88	81.55	81.02	91.64	0;
71.77	68.97	74.79	72.38	80.34	79.44	80.61	82.09	90.41	89.94	82.96	86.66	93.73	95.02	90.75	90.14	80.72	92.20 ];

[lexcoh,f] = lexphase(tmpdata, srate, [0 4; 4 8; 8 13; 13 32; 32 64]);

fprintf('Matching with the average Lexicor phase is good but the individual values are quite different\n')
fprintf('----------------------------------------------------------------------------------------------\n')
diffarray = phasevalstheta-lexcoh(2:end,1:end-1,2);
disp('Theta freq.');
fprintf('Nb values inferior in lex:%d\n', length(find(diffarray < 0)));
fprintf('Nb values superior in lex:%d\n', length(find(diffarray > 0)));
diffarray(find(diffarray == 0)) = NaN;
fprintf('Absolute difference:%3.2f +- %1.2f\n', nanmean(abs(diffarray(:))), nanstd(abs(diffarray(:))));

fprintf('\n');
disp('Alpha freq.');
diffarray = phasevalsalpha-lexcoh(2:end,1:end-1,3);
fprintf('Nb values inferior in lex:%d\n', length(find(diffarray < 0)));
fprintf('Nb values superior in lex:%d\n', length(find(diffarray > 0)));
diffarray(find(diffarray == 0)) = NaN;
fprintf('Absolute difference:%3.2f +- %1.2f\n', nanmean(abs(diffarray(:))), nanstd(abs(diffarray(:))));

